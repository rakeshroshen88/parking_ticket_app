(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"/2RN":function(t,e,n){"use strict";n.r(e),n.d(e,"DashboardPageModule",(function(){return q}));var i=n("ofXK"),r=n("3Pt+"),a=n("TEn/"),s=n("tyNb"),o=n("mrSG"),c=n("fXoL"),l=n("nCAS"),d=n("RFg5"),b=n("BHm0"),u=n("WdVq"),h=n("bmg4");function p(t,e){if(1&t&&(c.Pb(0,"h3",11),c.vc(1),c.cc(2,"date"),c.Ob()),2&t){const t=c.bc(2);c.xb(1),c.xc("Out Time: ",c.ec(2,1,null==t.userdetails?null:t.userdetails.time_out,"shortTime")," ")}}function f(t,e){if(1&t&&(c.Pb(0,"div"),c.Kb(1,"ngx-qrcode",16),c.Ob()),2&t){const t=c.bc(2);c.xb(1),c.hc("value",t.createdCode)}}function g(t,e){if(1&t&&(c.Pb(0,"div",5),c.Pb(1,"div",6),c.Kb(2,"img",7),c.Pb(3,"h3"),c.vc(4,"Parking Company Name"),c.Ob(),c.Pb(5,"h5",8),c.vc(6),c.Ob(),c.Pb(7,"h6",9),c.vc(8,"Parking Receipt"),c.Ob(),c.Pb(9,"h3",10),c.vc(10),c.cc(11,"date"),c.Ob(),c.Pb(12,"h3",11),c.vc(13),c.cc(14,"date"),c.Ob(),c.uc(15,p,3,4,"h3",12),c.Pb(16,"p",13),c.vc(17,"Charges: \u20a600.00 "),c.Ob(),c.Pb(18,"p",13),c.vc(19),c.Ob(),c.Ob(),c.Pb(20,"div",14),c.Pb(21,"p"),c.vc(22,"Thank you and drive Safaly"),c.Ob(),c.uc(23,f,2,1,"div",15),c.Ob(),c.Ob()),2&t){const t=c.bc();c.xb(6),c.xc("",null==t.userdetails?null:t.userdetails.car_number," "),c.xb(4),c.xc("",c.dc(11,6,null==t.userdetails?null:t.userdetails.time_in)," "),c.xb(3),c.xc("In Time: ",c.ec(14,8,null==t.userdetails?null:t.userdetails.time_in,"shortTime")," "),c.xb(2),c.hc("ngIf",null==t.userdetails?null:t.userdetails.time_out),c.xb(4),c.xc("Status: ",null==t.userdetails?null:t.userdetails.status," "),c.xb(4),c.hc("ngIf",t.createdCode)}}function m(t,e){if(1&t){const t=c.Qb();c.Pb(0,"button",19),c.Xb("click",(function(){return c.rc(t),c.bc(2).exit_car()})),c.Kb(1,"i",20),c.vc(2," Mark as Exit"),c.Ob()}}function v(t,e){if(1&t&&(c.Pb(0,"div",17),c.uc(1,m,3,0,"button",18),c.Ob()),2&t){const t=c.bc();c.xb(1),c.hc("ngIf",!(null!=t.userdetails&&t.userdetails.time_out))}}let P=(()=>{class t{constructor(t,e,n,i,r,a,s){this.authService=t,this.stroageServices=e,this.router=n,this.alert=i,this.barcodeScanner=r,this.actiatedRoute=a,this.location=s,this.userData={car_number:""},this.qrData="",this.createdCode=null,this.scannedCode=null,this.electmentType="canvas";let o=this.actiatedRoute.snapshot.paramMap.get("id");this.userData.car_number=o,this.createdCode=o}ngOnInit(){this.createCode()}createCode(){this.authService.postData(this.userData,"get_car_details").then(t=>Object(o.a)(this,void 0,void 0,(function*(){this.resposeData=t,this.resposeData.car_details?this.userdetails=this.resposeData.car_details:this.alert.notification(this.resposeData.error.text,"danger")})),t=>{this.alert.notification("No Internet Connection ","danger")}),console.log(this.createdCode)}CloseModal(){this.location.back()}exit_car(){this.authService.postData(this.userData,"exit_car").then(t=>Object(o.a)(this,void 0,void 0,(function*(){this.resposeData1=t,this.resposeData1.car_status?this.alert.notification(this.resposeData1.car_status.text,"success"):this.alert.notification(this.resposeData1.error.text,"danger")})),t=>{this.alert.notification("No Internet Connection ","danger")}),console.log(this.createdCode)}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(l.a),c.Jb(d.a),c.Jb(s.g),c.Jb(b.a),c.Jb(u.a),c.Jb(s.a),c.Jb(i.g))},t.\u0275cmp=c.Db({type:t,selectors:[["app-car-details"]],decls:9,vars:2,consts:[[1,"edithead"],["src","../../../assets/img/back-arrrow.png","alt","back Arrow",1,"backbutton",3,"click"],[1,"container"],["class","tabledetails",4,"ngIf"],["class","footer-btton",4,"ngIf"],[1,"tabledetails"],[1,"logoiconpar"],["src","../../../assets/img/parking_car_icon.png"],[1,"carnumber"],[1,"parkinghead"],[1,"date"],[1,"Intime"],["class","Intime",4,"ngIf"],[1,"carges"],[1,"thanknodes"],[4,"ngIf"],[2,"width","100%",3,"value"],[1,"footer-btton"],[3,"click",4,"ngIf"],[3,"click"],["aria-hidden","true",1,"fa","fa-car"]],template:function(t,e){1&t&&(c.Pb(0,"ion-header",0),c.Pb(1,"ion-toolbar"),c.Pb(2,"ion-title"),c.Pb(3,"img",1),c.Xb("click",(function(){return e.CloseModal()})),c.Ob(),c.vc(4," Parking Details "),c.Ob(),c.Ob(),c.Ob(),c.Pb(5,"ion-content"),c.Pb(6,"div",2),c.uc(7,g,24,11,"div",3),c.Ob(),c.Ob(),c.uc(8,v,2,1,"div",4)),2&t&&(c.xb(7),c.hc("ngIf",e.userdetails),c.xb(1),c.hc("ngIf",e.userdetails))},directives:[a.n,a.C,a.B,a.k,i.k,h.b],pipes:[i.d],styles:[""],encapsulation:2}),t})();var O=n("7uwA");let C=(()=>{class t{constructor(t,e,n){this.btSerial=t,this.toastController=e,this.alertService=n}searchBluetoothPrinter(){return this.btSerial.list()}connectToBluetoothPrinter(t){return this.btSerial.connect(t)}disconnectBluetoothPrinter(){return this.btSerial.disconnect()}sendToBluetoothPrinter(t,e){this.connectToBluetoothPrinter(t).subscribe(t=>{this.btSerial.write(e).then(t=>{console.log("Print successful."),this.alertService.notification("Print successful","danger"),this.disconnectBluetoothPrinter()},t=>{console.log("there is an error printing to bluetooth printer"),this.alertService.notification("there is an error printing to bluetooth printer","danger")})},t=>{this.alertService.notification("there is an error connecting to bluetooth printer","danger")})}}return t.\u0275fac=function(e){return new(e||t)(c.Tb(O.a),c.Tb(a.M),c.Tb(b.a))},t.\u0275prov=c.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function D(t,e){if(1&t){const t=c.Qb();c.Pb(0,"ion-item",3),c.Xb("click",(function(){c.rc(t);const n=e.$implicit;return c.bc().selectPrinter(n.id)})),c.vc(1),c.Ob()}if(2&t){const t=e.$implicit;c.xb(1),c.yc(" ",t.name," ",t.id," ")}}let _=(()=>{class t{constructor(t,e,n,i,r,a){this.barcodeScanner=t,this.bluetoothSerial=e,this.alertCtrl=n,this.barkodScanner=i,this.print=r,this.modalController=a,this.qrData="",this.createdCode=null,this.scannedCode=null,this.electmentType="canvas",this.bluetoothList=[],e.enable()}ngOnInit(){}createCode(){this.createdCode=this.qrData,console.log(this.createdCode)}scanCode(){this.barcodeScanner.scan().then(t=>{this.scannedCode=t.text})}listPrinter(){this.print.searchBluetoothPrinter().then(t=>{this.bluetoothList=t})}selectPrinter(t){this.selectedPrinter=t,this.modalController.dismiss(t)}printStuff(){var t;t+="<table><tr><th>No</th> <th>Item</th> <th>Price</th></tr></table>",t+="<tr><td>1</td> <td>Dhoti Lungi Pagiti big name</td> <td>150</td></tr>",t+="<tr><td>1</td> <td>Dhoti </td> <td>250</td></tr>",t+="</table>",this.print.sendToBluetoothPrinter(this.selectedPrinter,t+="\n\n\n")}dismiss(){this.modalController.dismiss()}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(u.a),c.Jb(O.a),c.Jb(a.b),c.Jb(u.a),c.Jb(C),c.Jb(a.G))},t.\u0275cmp=c.Db({type:t,selectors:[["app-barcode-generator"]],decls:13,vars:2,consts:[[1,"pull-right",3,"click"],[3,"click",4,"ngFor","ngForOf"],["expand","full","color","danger",3,"click"],[3,"click"]],template:function(t,e){1&t&&(c.Pb(0,"ion-header"),c.Pb(1,"ion-toolbar"),c.Pb(2,"ion-title"),c.vc(3," Find Printer "),c.Pb(4,"span",0),c.Xb("click",(function(){return e.dismiss()})),c.vc(5,"Close"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(6,"ion-content"),c.Pb(7,"ion-list"),c.uc(8,D,2,2,"ion-item",1),c.Ob(),c.Pb(9,"div"),c.vc(10),c.Ob(),c.Pb(11,"ion-button",2),c.Xb("click",(function(){return e.listPrinter()})),c.vc(12," Search Printer! "),c.Ob(),c.Ob()),2&t&&(c.xb(8),c.hc("ngForOf",e.bluetoothList),c.xb(2),c.xc(" Selected Printer: ",e.selectedPrinter," "))},directives:[a.n,a.C,a.B,a.k,a.s,i.j,a.f,a.q],styles:[""]}),t})();var k=n("2MiI");function x(t,e){if(1&t&&(c.Pb(0,"span"),c.vc(1),c.Ob()),2&t){const t=c.bc();c.xb(1),c.xc(" ",t.selectedPrinter,"")}}function y(t,e){1&t&&(c.Pb(0,"span"),c.vc(1,"Find Printer"),c.Ob())}function S(t,e){if(1&t){const t=c.Qb();c.Pb(0,"ion-card"),c.Kb(1,"ngx-qrcode",10,11),c.Pb(3,"ion-card-content"),c.Pb(4,"button",12),c.Xb("click",(function(){c.rc(t);const e=c.qc(2);return c.bc().printStuff(e)})),c.vc(5,"Print Receipt"),c.Ob(),c.Ob(),c.Ob()}if(2&t){const t=c.bc();c.xb(1),c.hc("value",t.createdCode)}}const I=[{path:"",component:(()=>{class t{constructor(t,e,n,i,r,a,s){this.authService=t,this.stroageServices=e,this.router=n,this.alert=i,this.barcodeScanner=r,this.modalController=a,this.print=s,this.createdCode=null,this.scannedCode=null,this.userData={car_number:""}}ngOnInit(){this.gettingallAssign_orders()}gettingallAssign_orders(){}logout(){this.authService.logout()}createCode(){this.userData.car_number=this.qrData,this.authService.postData(this.userData,"enter_new_car").then(t=>Object(o.a)(this,void 0,void 0,(function*(){this.resposeData=t,this.resposeData.car_details?(this.userdetails=this.resposeData.car_details,console.log(this.userdetails),this.alert.notification("Car has been carked","success"),this.createdCode=this.qrData):this.alert.notification(this.resposeData.error.text,"danger")})),t=>{this.alert.notification("No Internet Connection ","danger")})}scanCode(){this.barcodeScanner.scan().then(t=>{this.scannedCode=t.text,this.userData.car_number=t.text}),this.authService.postData(this.userData,"get_car_details").then(t=>Object(o.a)(this,void 0,void 0,(function*(){this.resposeData=t,this.resposeData.car_details?(this.userdetails=this.resposeData.car_details,this.router.navigateByUrl("/dashboard/car-details/"+this.userdetails.car_number)):this.alert.notification(this.resposeData.error.text,"danger")})),t=>{this.alert.notification("No Internet Connection ","danger")})}find_blutooth(){return Object(o.a)(this,void 0,void 0,(function*(){const t=yield this.modalController.create({component:_,cssClass:"findblue-tooth"});return t.onDidDismiss().then(t=>{console.log("data came back from modal"),console.log(t),this.selectedPrinter=t.data}),yield t.present()}))}printStuff(t){return Object(o.a)(this,void 0,void 0,(function*(){const e=t.qrcElement.nativeElement.querySelector("img").src;console.log(e);var n=yield this.saveAsImage(t,this.userdetails.id);console.log(n);var i="http://iflex.ng/car-parking-api/img/logo-small.jpg";i+=e,i+="\n\n\n",i+="IBOM Christmas Celebration",i+="\n\n\n",i+="Car No: ",i+=this.userdetails.car_number,i+="\n\n\n",i+="Time In: ",i+=this.userdetails.time_in,i+="Thank you and drive Safaly ",i+="\n\n\n",yield this.print.sendToBluetoothPrinter(this.selectedPrinter,i)}))}saveAsImage(t,e){const n=t.qrcElement.nativeElement.querySelector("img").src;let i=this.convertBase64ToBlob(n);return this.readFile(i,"0",this.createFileName(),e)}convertBase64ToBlob(t){const e=t.split(";base64,"),n=e[0].split(":")[1],i=window.atob(e[1]),r=new Uint8Array(i.length);for(let a=0;a<i.length;++a)r[a]=i.charCodeAt(a);return new Blob([r],{type:n})}createFileName(){return(new Date).getTime()+".jpg"}readFile(t,e,n,i){const r=new FileReader;r.onload=()=>{const a=new FormData,s=new Blob([r.result],{type:t.type});return a.append("file",s,n),a.append("user_id",e),a.append("carId",i),this.uploadImageData(a,t)},r.readAsArrayBuffer(t)}uploadImageData(t,e){return Object(o.a)(this,void 0,void 0,(function*(){console.log(t),this.authService.post_upload(t,"upload.php/signup_profile_upload").then(t=>Object(o.a)(this,void 0,void 0,(function*(){if(this.result22=t,this.result22.qr_code_path)return console.log(this.result22.qr_code_path),this.result22.qr_code_path})))}))}}return t.\u0275fac=function(e){return new(e||t)(c.Jb(l.a),c.Jb(d.a),c.Jb(s.g),c.Jb(b.a),c.Jb(u.a),c.Jb(a.G),c.Jb(C))},t.\u0275cmp=c.Db({type:t,selectors:[["app-dashboard"]],decls:19,vars:7,consts:[[1,"container"],[1,"dashborard-icon"],[1,"pull-right",3,"click"],[4,"ngIf"],[1,"ion-padding"],["regiform","ngForm"],["type","text","placeholder","My QR data","name","qrData1","placeholder","Car Number","requied","",3,"ngModel","ngModelChange"],["qrData1","ngModel"],[3,"disabled","click"],["ion-button","","full","","icon-left","",3,"click"],[2,"width","100%",3,"value"],["parent",""],[1,"print-btn",3,"click"]],template:function(t,e){if(1&t&&(c.Kb(0,"app-header"),c.Pb(1,"ion-content"),c.Pb(2,"div",0),c.Pb(3,"div",1),c.Pb(4,"h3"),c.vc(5),c.Pb(6,"span",2),c.Xb("click",(function(){return e.find_blutooth()})),c.uc(7,x,2,1,"span",3),c.uc(8,y,2,0,"span",3),c.Ob(),c.Ob(),c.Pb(9,"div",4),c.Pb(10,"form",null,5),c.Pb(12,"ion-input",6,7),c.Xb("ngModelChange",(function(t){return e.qrData=t})),c.Ob(),c.Pb(14,"button",8),c.Xb("click",(function(){return e.createCode()})),c.vc(15," Create Ticket "),c.Ob(),c.Pb(16,"button",9),c.Xb("click",(function(){return e.scanCode()})),c.vc(17," Scan Code "),c.Ob(),c.Ob(),c.uc(18,S,6,1,"ion-card",3),c.Ob(),c.Ob(),c.Ob(),c.Ob()),2&t){const t=c.qc(11);c.xb(5),c.yc("Welcome ",null==e.userdetails?null:e.userdetails.first_name," ",null==e.userdetails?null:e.userdetails.last_name," "),c.xb(2),c.hc("ngIf",e.selectedPrinter),c.xb(1),c.hc("ngIf",!e.selectedPrinter),c.xb(4),c.hc("ngModel",e.qrData),c.xb(2),c.hc("disabled",t.invalid),c.xb(4),c.hc("ngIf",e.createdCode)}},directives:[k.a,a.k,i.k,r.t,r.k,r.l,a.p,a.L,r.j,r.m,a.h,h.b,a.i],styles:[""]}),t})()},{path:"car-details/:id",component:P},{path:"profile",loadChildren:()=>n.e(12).then(n.bind(null,"3cVy")).then(t=>t.ProfilePageModule)}];let w=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[s.j.forChild(I)],s.j]}),t})();var T=n("j1ZV");let q=(()=>{class t{}return t.\u0275mod=c.Hb({type:t}),t.\u0275inj=c.Gb({factory:function(e){return new(e||t)},imports:[[i.b,r.e,a.D,T.a,h.a,w]]}),t})()},"2MiI":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("fXoL"),r=n("TEn/");let a=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Db({type:t,selectors:[["app-header"]],decls:6,vars:1,consts:[[3,"translucent"],[1,"header"],["slot","start"],["src","../../../assets/img/header-logo.png"]],template:function(t,e){1&t&&(i.Pb(0,"ion-header",0),i.Pb(1,"ion-toolbar",1),i.Pb(2,"ion-buttons",2),i.Kb(3,"ion-menu-button"),i.Ob(),i.Pb(4,"ion-title"),i.Kb(5,"img",3),i.Ob(),i.Ob(),i.Ob()),2&t&&i.hc("translucent",!0)},directives:[r.n,r.C,r.g,r.u,r.B],styles:[""]}),t})()},j1ZV:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("ofXK"),r=n("tyNb"),a=n("TEn/"),s=n("fXoL");let o=(()=>{class t{}return t.\u0275mod=s.Hb({type:t}),t.\u0275inj=s.Gb({factory:function(e){return new(e||t)},imports:[[a.D,i.b,r.j],r.j]}),t})()}}]);